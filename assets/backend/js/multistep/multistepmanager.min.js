!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.ZgfmManager=e()}(this,(function(){return class{constructor(t){this.$uifm=t;var e=document.getElementById("zgfmFlowSection");this.editor=new Drawflow(e),this.availableForms={},this.activeNodeId=0,this.activeFormId=0,this.activeConnection="",this.multistepSettings={app_ver:"0.0.0",name:"",initial:0,main:{submit_ajax:"1",add_css:"",add_js:"",onload_scroll:"0",preload_noconflict:"1",pdf_charset:"UTF-8",pdf_font:"2",pdf_paper_size:"a4",pdf_paper_orie:"landscape",pdf_html_fullpage:"0",email_html_fullpage:"0",email_dissubm:"0"},skin:{form_font:{show_st:"0",font:""},form_width:{show_st:"0",max:"800"},form_padding:{show_st:"1",pos_top:"20",pos_right:"17",pos_bottom:"20",pos_left:"17"},form_background:{show_st:"1",type:"1",start_color:"#eeeeee",end_color:"#ffffff",solid_color:"#ffffff",image:""},form_border_radius:{show_st:"0",size:"5"},form_border:{show_st:"0",color:"#000",style:"1",width:"1"},form_shadow:{show_st:"1",color:"#CCCCCC",h_shadow:"3",v_shadow:"3",blur:"10"}},onsubm:{sm_successtext:"<div class='rockfm-alert rockfm-alert-success' role='alert'>Success! Form was sent successfully.</div>",sm_boxmsg_bg_st:"0",sm_boxmsg_bg_type:"1",sm_boxmsg_bg_solid:"",sm_boxmsg_bg_start:"",sm_boxmsg_bg_end:"",sm_redirect_st:"0",sm_redirect_url:"",mail_from_email:"",mail_from_name:"",mail_template_msg:"",mail_recipient:"",mail_cc:"",mail_bcc:"",mail_subject:"",mail_usr_st:"0",mail_usr_template_msg:"",mail_usr_pdf_st:"0",mail_usr_pdf_store:"0",mail_usr_pdf_template_msg:"",mail_usr_pdf_fn:"",mail_usr_recipient:"",mail_usr_recipient_name:"",mail_usr_cc:"",mail_usr_bcc:"",mail_usr_subject:""},availableConnections:{},availableNodes:{},connections:{},progressBar:{enable_st:"0",position:"outertop",theme_type:"numbers",theme:{default:{skin_tab_cur_bgcolor:"#4798E7",skin_tab_cur_txtcolor:"#ffffff",skin_tab_cur_numtxtcolor:"#4798E7",skin_tab_inac_bgcolor:"#ECF0F1",skin_tab_inac_txtcolor:"#95A5A6",skin_tab_inac_numtxtcolor:"#ECF0F1",skin_tab_done_bgcolor:"#9a8afa",skin_tab_done_txtcolor:"#ffffff",skin_tab_done_numtxtcolor:"#ECF0F1",skin_tab_cont_bgcolor:"#F9F9F9",skin_tab_cont_borcol:"#D4D4D4",skin_tab_default_txt_bgcolor:"#fff"},numbers:{skin_tab_cur_bgcolor:"#4798E7",skin_tab_cur_txtcolor:"#000000",skin_tab_cur_numtxtcolor:"#4798E7",skin_tab_cur_bg_numtxt:"#ffffff",skin_tab_inac_bgcolor:"#cccccc",skin_tab_inac_txtcolor:"#95A5A6"},numbers2:{skin_tab_cur_bgcolor:"#4798E7",skin_tab_cur_txtcolor:"#000000",skin_tab_inac_bgcolor:"#cccccc",skin_tab_inac_txtcolor:"#95A5A6"}},steps:{},progressBarAssigned:[]}}}saveRoute(){this.multistepSettings.connections={};let t=this.getDrawflowArr().drawflow.zigaform.data;for(let e in t)if(t.hasOwnProperty(e)){let i=t[e].data.id;if(this.multistepSettings.connections[i]={inputs:[],outputs:[]},Object.keys(t[e].outputs).length)for(let a in t[e].outputs.output_1.connections)if(t[e].outputs.output_1.connections.hasOwnProperty(a)){let s=t[t[e].outputs.output_1.connections[a].node].data.id;this.multistepSettings.connections[i].outputs.push({form:s,conn:`${i}__${s}`})}if(Object.keys(t[e].inputs).length)for(let a in t[e].inputs.input_1.connections)if(t[e].inputs.input_1.connections.hasOwnProperty(a)){let s=t[t[e].inputs.input_1.connections[a].node].data.id;this.multistepSettings.connections[i].inputs.push({form:s,conn:`${i}__${s}`})}}}rollbackLoadChildForms(t){const e=this;this.availableForms={};for(let i in t)if(t.hasOwnProperty(i)){let a=t[i].id;e.availableForms[a]={},e.availableForms[a].id=a,e.availableForms[a].core=t[i].data,e.availableForms[a].preview=t[i].preview}}rollback(t){this.multistepSettings=t.data.parent.data.data2,this.loadFormRollback(t),this.activeFormId=0,this.$uifm('.sfdc-nav-tabs a[href="#uiformc-menu-secmm"]').sfdc_tab("show")}init(){const t=this;this.buttonsClicks(),this.events(),this.editor.reroute=!0,this.editor.editor_mode="edit",this.editor.start(),this.editor.addModule("zigaform"),this.editor.changeModule("zigaform");var e=this.$uifm,i=this.editor;this.$uifm('.uiformc-menu-wrap ul.sfdc-nav-tabs a[data-toggle="sfdc-tab"]').on("shown.bs.sfdc-tab",(function(i){var a=e(i.target),s=e(i.relatedTarget);if("#uiformc-menu-sec1"===a.attr("href")&&(0===t.activeFormId?t.$uifm("#uifm_mm_form_not_selected").show():t.$uifm("#uifm_mm_form_not_selected").hide()),"#uiformc-menu-sec1"===s.attr("href")){if(0===t.activeFormId)return;t.saveCurrentSelectedFormToCore()}})),this.editor.on("uifmNodeUnselected",(function(e){delete t.availableForms[e]})),this.editor.on("nodeSelected",(function(a){var s=i.getNodeFromId(a).data.id;t.activeFormId=s,t.activeNodeId=a,e("#uifm_frm_main_id").val(s),e(".uiform-items-container").html(""),rocketform.refreshPreviewSectionMultistep(),t.progresstab_loadSettings(t,!1,!1),t.progresstab_refreshPreview()})),this.editor.on("nodeUnselected",(function(e){t.activeFormId=0,t.activeNodeId=0,t.activeConnection=""})),this.editor.on("connectionCreated",(function(e){a(e);let i=t.editor.getNodeFromId(e.output_id),s=t.editor.getNodeFromId(e.input_id),r=`${i.data.id}__${s.data.id}`;t.multistepSettings.availableConnections[r]={rules:{is_fallback:0,top_condition:1,list:[]},start:{},end:{}},t.multistepSettings.availableConnections[r].start.id=i.data.id,t.multistepSettings.availableConnections[r].start.name=t.availableForms[i.data.id].name,t.multistepSettings.availableConnections[r].end.id=s.data.id,t.multistepSettings.availableConnections[r].end.name=t.availableForms[s.data.id].name,t.activeConnection=r})),this.editor.on("connectionRemoved",(function(e){let i=e.output_id,a=e.input_id,s=t.editor.getNodeFromId(i),r=t.editor.getNodeFromId(a),o=`${s.data.id}__${r.data.id}`;t.activeConnection=o,delete t.multistepSettings.availableConnections[o],t.modalConnSettings.removeClass("open"),t.activeConnection=""})),this.editor.on("connectionSelected",(function(e){let i=e.output_id,a=e.input_id;t.$uifm("#uifm_mm_connection_infobox .uifm_main_rules2").html(""),t.modalConnSettings.addClass("open");let s=t.editor.getNodeFromId(i),r=t.editor.getNodeFromId(a),o=`${s.data.id}__${r.data.id}`;t.activeConnection=o;let n=t.multistepSettings.availableConnections[o].start.name,l=t.multistepSettings.availableConnections[o].end.name;t.activeFormId=t.multistepSettings.availableConnections[o].start.id,t.$uifm("#uifm_mm_connection_infobox #conn_node1").html(n),t.$uifm("#uifm_mm_connection_infobox #conn_node2").html(l);var m=1===parseInt(t.multistepSettings.availableConnections[t.activeConnection].rules.is_fallback);t.$uifm("#uifm_mm_connection_infobox_fallback").bootstrapSwitchZgpb("state",m),!1===m?t.$uifm("#uifm_main_rules_dyn").show():t.$uifm("#uifm_main_rules_dyn").hide(),t.clogic_tabeditor_generateAllOptions(t.multistepSettings.availableConnections[t.activeConnection].rules.list)})),this.editor.on("connectionUnselected",(function(e){t.modalConnSettings.removeClass("open"),t.activeConnection="",t.$uifm("#uifm_mm_connection_infobox .uifm_main_rules2").html(""),t.activeFormId=0}));const a=t=>{const i=e(`.node_in_node-${t.input_id}.node_out_node-${t.output_id}`).find("path.main-path");if(i.length){i.css({"stroke-dasharray":"10,5",animation:"dash 2s linear infinite"});const t=document.createElement("style");t.innerHTML="\n\t\t\t\t\t@keyframes dash {\n\t\t\t\t\t\tto {\n\t\t\t\t\t\t\tstroke-dashoffset: -15;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t",document.head.appendChild(t)}};this.modalConnSettings=this.$uifm("#uifm_mm_connection_infobox")}clogic_tabeditor_generateAllOptions(t){this.$uifm("#uifm_mm_connection_infobox .uifm_main_rules2").html("");const e=this;var i,a,s=this.$uifm("#uifm_mm_connection_infobox .uifm_main_rules2");this.$uifm.each(t,(function(t,r){if(r){i=t,(a=e.$uifm("#uiform-mm-set-clogic-tmpl .uifm-conditional-row").clone()).attr("data-row-index",i),s.append(a),e.clogic_getListField(a),a.find(".uifm_clogic_fieldsel").val(r.field_fire).trigger("chosen:updated");var o=e.search_fieldById(r.field_fire);if(e.clogic_getTypeMatch(a,o.type),1===parseInt(a.find(".uifm_clogic_mtype").attr("data-loaded"))&&(a.find(".uifm_clogic_mtype select").val(r.mtype).trigger("chosen:updated"),e.clogic_getMatchInput(a,o),1===parseInt(a.find(".uifm_clogic_minput").attr("data-loaded"))))switch(parseInt(o.type)){case 8:case 9:case 10:case 11:case 41:case 42:0!=parseInt(a.find(".uifm_clogic_minput_1").find('option[value="'+r.minput+'"]').length)?a.find(".uifm_clogic_minput_1").val(r.minput).trigger("chosen:updated"):e.clogic_tabeditor_removeifnomatch(t);break;case 40:var n;n=1===parseInt(r.minput)?"1":"0",a.find(".uifm_clogic_minput_1").val(n).trigger("chosen:updated");break;case 16:case 18:a.find(".uifm_clogic_minput_2").val(r.minput)}}else e.clogic_tabeditor_removeifnomatch(t)}))}clogic_tabeditor_removeifnomatch(t){var e=t;this.$uifm("#uifm_mm_connection_infobox .uifm_main_rules2").find('.uifm-conditional-row[data-row-index="'+t+'"]').remove(),delete this.multistepSettings.availableConnections[this.activeConnection].rules.list[parseInt(e)];var i,a=this.multistepSettings.availableConnections[this.activeConnection].rules.list,s=a.length;for(i=0;i<s;i++)a[i]&&a.push(a[i]);this.$uifm.isArray(a)&&(a.splice(0,s),this.multistepSettings.availableConnections[this.activeConnection].rules.list=a)}clogic_deleteConditional(t){var e=this.$uifm(t),i=e.closest(".uifm-conditional-row").data("row-index");e.closest(".uifm-conditional-row").remove(),delete this.multistepSettings.availableConnections[this.activeConnection].rules.list[parseInt(i)];var a,s=this.multistepSettings.availableConnections[this.activeConnection].rules.list,r=s.length;for(a=0;a<r;a++)s[a]&&s.push(s[a]);this.$uifm.isArray(s)&&(s.splice(0,r),this.multistepSettings.availableConnections[this.activeConnection].rules.list=s)}clogic_getTypeMatch(t,e){var i;switch(t.find(".uifm_clogic_mtype").html(""),t.find(".uifm_clogic_mtype").attr("data-loaded","0"),t.find(".uifm_clogic_mtype").append('<i class="sfdc-glyphicon sfdc-glyphicon-refresh sfdc-gly-spin sfdc-spin1"></i>'),t.find(".uifm_clogic_mtype").find(".sfdc-gly-spin").fadeOut("slow").remove(),parseInt(e)){case 8:case 9:case 10:case 11:case 40:case 41:case 42:i=this.$uifm("#uiform-mm-set-clogic-tmpl .uifm_clogic_mtypeinp_1").clone();break;case 16:case 18:i=this.$uifm("#uiform-mm-set-clogic-tmpl .uifm_clogic_mtypeinp_2").clone()}t.find(".uifm_clogic_mtype").append(i),t.find(".uifm_clogic_mtypeinp").chosen({width:"100%"}),t.find(".uifm_clogic_mtype").attr("data-loaded","1")}clogic_changeField(t){const e=this;var i=this.$uifm(t),a=i.closest(".uifm-conditional-row"),s=(i.val(),a.data("row-index")),r=a.find(".uifm_clogic_fieldsel").chosen().val(),o=this.search_fieldById(r);this.clogic_getTypeMatch(a,o.type);var n=setInterval((function(){if(1===parseInt(a.find(".uifm_clogic_mtype").attr("data-loaded"))){var t=a.find(".uifm_clogic_mtype select").chosen().val();e.clogic_getMatchInput(a,o);var i=setInterval((function(){if(1===parseInt(a.find(".uifm_clogic_minput").attr("data-loaded"))){var n;switch(parseInt(o.type)){case 8:case 9:case 10:case 11:case 41:case 42:n=a.find(".uifm_clogic_minput_1").chosen().val();break;case 40:case 16:case 18:n=a.find(".uifm_clogic_minput_2").val()}e.multistepSettings.availableConnections[e.activeConnection].rules.list[parseInt(s)].field_fire=r,e.multistepSettings.availableConnections[e.activeConnection].rules.list[parseInt(s)].mtype=t,e.multistepSettings.availableConnections[e.activeConnection].rules.list[parseInt(s)].minput=n,clearInterval(i),i=null}}),500);clearInterval(n),n=null}}),500)}clogic_changeMinput(t){var e,i=this.$uifm(t).closest(".uifm-conditional-row"),a=i.data("row-index"),s=i.find(".uifm_clogic_fieldsel").chosen().val(),r=i.find('.uifm_clogic_fieldsel [value="'+s+'"]').data("type");switch(parseInt(r)){case 8:case 9:case 10:case 11:case 40:case 41:case 42:e=i.find(".uifm_clogic_minput_1").chosen().val();break;case 16:case 18:e=i.find(".uifm_clogic_minput_2").val()}this.multistepSettings.availableConnections[this.activeConnection].rules.list[parseInt(a)].minput=e}clogic_changeMtype(t){var e=this.$uifm(t).closest(".uifm-conditional-row"),i=e.find(".uifm_clogic_mtype select").chosen().val(),a=e.data("row-index");this.multistepSettings.availableConnections[this.activeConnection].rules.list[parseInt(a)].mtype[i]}clogic_getListField(t){var e=this.$uifm("#uiform-mm-set-clogic-tmpl .uifm_clogic_fieldsel").clone(),i=this.availableForms[this.multistepSettings.availableConnections[this.activeConnection].start.id].core.steps_src,a=[8,9,10,11,16,18,40,41,42],s="";const r=this;return this.$uifm.each(i,(function(t,e){r.$uifm.each(e,(function(t,e){r.$uifm.inArray(parseInt(e.type),a)>=0&&(s+='<option data-type="'+e.type+'" value="'+e.id+'">'+e.field_name+"</option>")}))})),e.append(s),t.find(".uifm_clogic_field").append(e),t.find(".uifm_clogic_fieldsel").chosen({width:"100%"}),!0}search_fieldById(t){var e=this.availableForms[this.multistepSettings.availableConnections[this.activeConnection].start.id].core.steps_src;for(var i in e)for(var a in e[i])if(String(e[i][a].id)===String(t))return e[i][a];return!1}clogic_getMatchInput(t,e){var i,a,s;switch(t.find(".uifm_clogic_minput").html(""),t.find(".uifm_clogic_minput").attr("data-loaded","0"),t.find(".uifm_clogic_minput").append('<i class="sfdc-glyphicon sfdc-glyphicon-refresh sfdc-gly-spin sfdc-spin1"></i>'),t.find(".uifm_clogic_minput").find(".sfdc-gly-spin").fadeOut("slow").remove(),parseInt(e.type)){case 8:case 9:case 10:case 11:i=this.$uifm("#uiform-mm-set-clogic-tmpl .uifm_clogic_minput_1").clone(),(s=e.input2.options)&&(a="",this.$uifm.each(s,(function(t,e){a+='<option value="'+t+'">'+e.value+"</option>"})),i.append(a)),t.find(".uifm_clogic_minput").append(i),t.find(".uifm_clogic_minput_1").chosen({width:"100%"});break;case 41:case 42:i=this.$uifm("#uiform-mm-set-clogic-tmpl .uifm_clogic_minput_1").clone(),(s=e.input17.options)&&(a="",this.$uifm.each(s,(function(t,e){a+='<option value="'+t+'">'+e.label+"</option>"})),i.append(a)),t.find(".uifm_clogic_minput").append(i),t.find(".uifm_clogic_minput_1").chosen({width:"100%"});break;case 40:i=this.$uifm("#uiform-mm-set-clogic-tmpl .uifm_clogic_minput_1").clone(),a="",a+='<option value="0">'+e.input15.txt_no+"</option>",a+='<option value="1">'+e.input15.txt_yes+"</option>",i.append(a),t.find(".uifm_clogic_minput").append(i),t.find(".uifm_clogic_minput_1").chosen({width:"100%"});break;case 16:case 18:i=this.$uifm("#uiform-mm-set-clogic-tmpl .uifm_clogic_minput_2").clone();var r=e.input4.set_min,o=e.input4.set_max,n=e.input4.set_default,l=e.input4.set_step;t.find(".uifm_clogic_minput").append(i),t.find(".uifm_clogic_minput_2").TouchSpin({verticalbuttons:!0,min:parseFloat(r),max:parseFloat(o),stepinterval:parseFloat(l),verticalupclass:"sfdc-glyphicon sfdc-glyphicon-plus",verticaldownclass:"sfdc-glyphicon sfdc-glyphicon-minus",initval:parseFloat(n)})}t.find(".uifm_clogic_minput").attr("data-loaded","1")}clogic_changeTopCondition(t){let e=this.$uifm(t).val();this.multistepSettings.availableConnections[this.activeConnection].rules.top_condition=e}clogic_addNewConditional(){const t=this;var e=this.$uifm("#uifm_mm_connection_infobox .uifm_main_rules2"),i=this.$uifm("#uifm_mm_connection_infobox .uifm_main_rules2 .uifm-conditional-row").length,a=parseInt(i),s=this.$uifm("#uiform-mm-set-clogic-tmpl .uifm-conditional-row").clone();s.attr("data-row-index",a),e.append(s),this.clogic_getListField(s);var r=s.find(".uifm_clogic_fieldsel").chosen().val(),o=this.search_fieldById(r);this.clogic_getTypeMatch(s,o.type);var n=setInterval((function(){if(console.log(" logic_row.find('.uifm_clogic_mtype').attr('data-loaded') "+s.find(".uifm_clogic_mtype").attr("data-loaded")),1===parseInt(s.find(".uifm_clogic_mtype").attr("data-loaded"))){var e=s.find(".uifm_clogic_mtype select").chosen().val();t.clogic_getMatchInput(s,o);var i=setInterval((function(){if(1===parseInt(s.find(".uifm_clogic_minput").attr("data-loaded"))){var n;switch(parseInt(o.type)){case 8:case 9:case 10:case 11:case 41:case 42:n=s.find(".uifm_clogic_minput_1").chosen().val();break;case 40:case 16:case 18:n=s.find(".uifm_clogic_minput_2").val()}var l=t.multistepSettings.availableConnections[t.activeConnection].rules.list;l&&t.$uifm.each(l,(function(t,e){""!==String(e)&&null!==e||l.splice(t,1)})),t.multistepSettings.availableConnections[t.activeConnection].rules.list=l,t.multistepSettings.availableConnections[t.activeConnection].rules.list[parseInt(a)]={},t.multistepSettings.availableConnections[t.activeConnection].rules.list[parseInt(a)]={field_fire:r,mtype:e,minput:n},clearInterval(i),i=null}}),500);clearInterval(n),n=null}}),500)}debugCurrentSelectedForm(){return this.availableForms[this.activeFormId]}saveCurrentSelectedFormToCore(){if(0===this.activeFormId)return;rocketform.saveFormOnBackground();let t=$uifm("#uifm_frm_main_title").val()||"";""!=t&&this.changeNodeName(this.activeNodeId,t),this.changeNodeName(this.activeNodeId,t),this.availableForms[this.activeFormId].name=t,this.availableForms[this.activeFormId].preview=$uifm(".uiform-preview-base").html()}events(){}loadMultistep(t){this.multistepSettings=this.$uifm.extend(!0,{},this.multistepSettings,t.data.fmb_data2),this.fixData(),this.$uifm("#uifm_mm_settings_title").val(this.multistepSettings.name)}fixData(){this.$uifm.isArray(this.multistepSettings.availableConnections)&&(this.multistepSettings.availableConnections={}),this.$uifm.isArray(this.multistepSettings.availableNodes)&&(this.multistepSettings.availableNodes={})}getUiData2=function(t,e){try{return this.multistepSettings[t][e]}catch(t){console.log("error getUiData2: "+t.message)}};spliceUiData3=function(t,e,i){parseInt(i)>-1&&this.multistepSettings[t][e].splice(parseInt(i),1)};delUiData3=function(t,e,i){delete this.multistepSettings[t][e][i]};addIndexUiData2=function(t,e,i){void 0===this.multistepSettings[t][e]||(this.multistepSettings[t][e][i]={})};setUiData3=function(t,e,i,a){this.multistepSettings.hasOwnProperty(t)||(this.multistepSettings[t]={}),this.multistepSettings[t].hasOwnProperty(e)||(this.multistepSettings[t][e]={}),this.multistepSettings[t][e][i]=a};getUiData3=function(t,e,i){try{return this.multistepSettings[t][e][i]}catch(t){console.log("error mm_getUiData3: "+t.message)}};getUiData4=function(t,e,i,a){try{return this.multistepSettings[t][e][i][a]}catch(s){console.log("error getUiData4: name: "+t+" index:"+e+" key:"+i+" option:"+a+" error:"+s.message)}};setUiData4=function(t,e,i,a,s){this.multistepSettings.hasOwnProperty(t)||(this.multistepSettings[t]={}),this.multistepSettings[t].hasOwnProperty(e)||(this.multistepSettings[t][e]={}),this.multistepSettings[t][e].hasOwnProperty(i)||(this.multistepSettings[t][e][i]={}),this.multistepSettings[t][e][i][a]=s};buttonsClicks(){const t=this;this.button=document.getElementById("zgfm_m_showmodal"),this.button&&this.button.addEventListener("click",this.handleClick.bind(this)),this.button2=document.getElementById("zgfm_m_opt_export"),this.button2&&this.button2.addEventListener("click",this.handleClickShowExport.bind(this)),this.button3=document.getElementById("zgfm_m_opt_zoomreset"),this.button3&&this.button3.addEventListener("click",this.handleClickZoomReset.bind(this)),this.button4=document.getElementById("zgfm_m_opt_zoomin"),this.button4&&this.button4.addEventListener("click",this.handleClickZoomIn.bind(this)),this.button5=document.getElementById("zgfm_m_opt_zoomout"),this.button5&&this.button5.addEventListener("click",this.handleClickZoomOut.bind(this)),this.button6=document.getElementById("zgfm_m_addnewform"),this.button6&&this.button6.addEventListener("click",this.handleClickNewForm.bind(this)),this.button7=document.getElementById("uifm_mm_connection_infobox_btn_close"),this.button7&&this.button7.addEventListener("click",this.handleClickConnBtnClose.bind(this)),this.button8=document.getElementById("uifm_mm_connection_infobox_btn_delete_connection"),this.button8&&this.button8.addEventListener("click",this.handleClickConnDelete.bind(this)),this.button9=document.getElementById("uifm_mm_connection_infobox_newcond"),this.button9&&this.button9.addEventListener("click",this.handleClickConnBtnNewCond.bind(this)),this.$uifm(document).on("change keyup focus keypress","#uifm_mm_settings_title",(function(e){var i=t.$uifm(this).val();i&&(t.multistepSettings.name=i)})),this.$uifm(document).on("change","#uifm_mm_settings_initialform",(function(e){var i=t.$uifm(this).val();if(i!==t.multistepSettings.initial&&parseInt(i)>0){t.multistepSettings.initial=i;let e=t.multistepSettings.availableNodes[i];t.updateNodeNumInToZero(t.editor,e)}})),this.$uifm("#uifm_mm_connection_infobox .switch-field").on("switchChange.bootstrapSwitchZgpb",(function(e,i){var a=i?1:0;t.multistepSettings.availableConnections[t.activeConnection].rules.is_fallback=a,0===a?t.$uifm("#uifm_main_rules_dyn").show():t.$uifm("#uifm_main_rules_dyn").hide()})),this.$uifm(document).on("change","#uifm_frm_pbar_theme_type",(function(e){var i=t.$uifm(this).val();t.multistepSettings.progressBar.theme_type=i,t.progresstab_updateSettingsTheme(i),t.progresstab_loadSettings(t,!0,!0),t.progresstab_refreshPreview()})),this.$uifm(document).on("change","#uifm_frm_pbar_theme_position",(function(e){var i=t.$uifm(this).val();t.multistepSettings.progressBar.position=i,t.progresstab_refreshPreview()})),this.$uifm.fn.colorpicker&&this.$uifm("#uiform-settings-tab3-6").find(".uifm-evt-progressbar-color").colorpicker().on("changeColor",(function(e){var i=t.$uifm(this).data("form-store"),a=t.$uifm(this).find("input").val();a&&(t.setUiData4("progressBar","theme",t.multistepSettings.progressBar.theme_type,i,a),t.progresstab_refreshPreview())}))}updateNodeNumInToZero(t,e){var i=t.getNodeFromId(e);if(i){var a=[];for(let t in i.inputs)i.inputs[t].connections.forEach(e=>{a.push({node:e.node,output:e.output,input:t})});a.forEach(i=>{t.removeSingleConnection(i.node,e,i.output,i.input)}),i.num_in=0,t.updateNodeDataFromId(e,i.data)}}handleClickConnBtnDelAllCond(){this.$uifm("#uifm_mm_connection_infobox .uifm_main_rules2").html(""),this.multistepSettings.availableConnections[this.activeConnection].rules.list=[]}handleClickConnBtnNewCond(){this.clogic_addNewConditional()}handleClickConnBtnClose(){this.modalConnSettings.removeClass("open"),this.editor.connection_selected.parentElement.querySelectorAll(".main-path").forEach((t,e)=>{t.classList.remove("selected")})}handleClickConnDelete(){this.handleClickConnBtnClose(),delete this.multistepSettings.availableConnections[this.activeConnection],this.editor.removeConnection()}loadFormRollback(t){this.editor.reroute=!0;const e={drawflow:{Home:{data:{}},zigaform:{}}};e.drawflow.zigaform.data=JSON.parse(JSON.stringify(t.data.parent.data.data.data));let i=e.drawflow.zigaform.data;for(let t in i)if(i.hasOwnProperty(t))for(let e in i[t])i[t].hasOwnProperty(e)&&"typenode"===e&&(i[t].typenode=!1);e.drawflow.zigaform.data=i;const a=e;this.editor.clear(),this.editor.import(a),this.rollbackLoadChildForms(t.data.children.data);const s=this.$uifm(".connection").find("path.main-path");if(s.length){s.css({"stroke-dasharray":"10,5",animation:"dash 2s linear infinite"});const t=document.createElement("style");t.innerHTML="\n\t\t\t\t\t@keyframes dash {\n\t\t\t\t\t\tto {\n\t\t\t\t\t\t\tstroke-dashoffset: -15;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t",document.head.appendChild(t)}}loadForm(t){this.editor.reroute=!0;const e={drawflow:{Home:{data:{}},zigaform:{}}};let i=t.data.fmb_data.data;if(this.$uifm.isArray(i)&&0===parseInt(i.length))return;if(0===parseInt(Object.keys(i).length))return;e.drawflow.zigaform.data=JSON.parse(JSON.stringify(t.data.fmb_data.data));let a=e.drawflow.zigaform.data;for(let t in a)if(a.hasOwnProperty(t))for(let e in a[t])a[t].hasOwnProperty(e)&&"typenode"===e&&(a[t].typenode=!1);e.drawflow.zigaform.data=a;const s=e;this.editor.clear(),this.editor.import(s),this.loadChildForms(a);const r=this.$uifm(".connection").find("path.main-path");if(r.length){r.css({"stroke-dasharray":"10,5",animation:"dash 2s linear infinite"});const t=document.createElement("style");t.innerHTML="\n\t\t\t\t\t@keyframes dash {\n\t\t\t\t\t\tto {\n\t\t\t\t\t\t\tstroke-dashoffset: -15;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t",document.head.appendChild(t)}}loadChildForms(t){const e=this;for(let i in t)if(t.hasOwnProperty(i)){let a=t[i].data.id;this.$uifm.ajax({type:"POST",url:rockfm_vars.uifm_siteurl+"formbuilder/forms/ajax_mm_load_childform",async:!1,data:{action:"rocket_fbuilder_mm_load_childform",page:"zgfm_form_builder",zgfm_security:uiform_vars.ajax_nonce,uifm_frm_main_child_id:a,csrf_field_name:uiform_vars.csrf_field_name},success:function(t){e.availableForms[a]={},e.availableForms[a].id=a,e.availableForms[a].core=t.data.fmb_data,e.availableForms[a].name=t.data.fmb_name,e.availableForms[a].preview=t.data.fmb_html_backend}})}}handleClick(){this.$uifm("#uifm_mm_settings_initialform").html("");for(let e in this.availableForms)if(this.availableForms.hasOwnProperty(e)){var t=this.$uifm("<option></option>").attr("value",this.availableForms[e].id).text(this.availableForms[e].name);this.$uifm("#uifm_mm_settings_initialform").append(t)}this.$uifm("#uifm_mm_settings_initialform").val(this.multistepSettings.initial),this.$uifm("#uifm_mm_settings_title").val(this.multistepSettings.name),this.$uifm("#uifm_mm_general").sfdc_modal("show")}getDrawflowArr(){return this.editor.getDrawflowArr()}handleClickShowExport(){this.editor.showExport()}handleClickZoomReset(){this.editor.zoom_reset()}handleClickZoomIn(){this.editor.zoom_in()}handleClickZoomOut(){this.editor.zoom_out()}handleClickNewForm(t){var e=this.$uifm,i=this.editor;const a=this,s=rocketform.getMainData();this.$uifm.ajax({type:"POST",url:rockfm_vars.uifm_siteurl+"multistep/dashboard/ajax_save_newform",async:!0,data:{action:"rocket_fbuilder_mm_save_newform",page:"zgfm_form_builder",zgfm_security:uiform_vars.ajax_nonce,form_data:encodeURIComponent(JSON.stringify(s)),uifm_frm_main_multistep_parent:this.$uifm("#uifm_frm_mm_main_id").val(),csrf_field_name:uiform_vars.csrf_field_name},success:function(t){if(parseInt(t.id)>0){e("#uifm_frm_main_id").val(t.id);var r={};let o;r.id=t.id,0==Object.keys(a.multistepSettings.availableNodes).length?(a.multistepSettings.availableNodes={},o=i.addNode(t.name,0,1,50,100,"",r,t.name),a.multistepSettings.initial=t.id):o=i.addNode(t.name,1,1,50,100,"",r,t.name),a.activeFormId=t.id,a.availableForms[t.id]={},a.availableForms[t.id].core=JSON.parse(JSON.stringify(s)),a.availableForms[t.id].id=t.id,a.availableForms[t.id].name=t.name,a.availableForms[t.id].preview='<div class="rockfm_form_hook_outertop"></div><div class="uiform-main-form" style="padding: 20px 17px; background: rgb(255, 255, 255); box-shadow: rgb(204, 204, 204) 3px 3px 10px;">\n\t\t\t\t\t <div class="rockfm_form_hook_innertop"></div>\n\t\t\t\t\t <div class="uiform-step-content" style="min-height:100px;">\n\t\t\t\t\t <div data-uifm-step="0" id="uifm-step-tab-0" class="uiform-step-pane" style="">\n\t\t\t\t\t <div id="" class="uiform-items-container uiform-tab-container ui-sortable"></div>\n\t\t\t\t\t </div>\n\t\t\t\t\t </div>\n\t\t\t\t\t </div>',a.changeNodeName(o,t.name),a.multistepSettings.availableNodes[t.id]=o}else alert("Error")}})}formvariables_generateTable_modal(){return this.formvariables_generateTable_process_main()}formvariables_generateTable(){this.$uifm("#uiform-form-mailset-vars-tab-1 .uifm-tab-inner-vars-1").html(this.formvariables_generateTable_process())}formvariables_generateTable_process_main(){return`\n\t\t <div class="sfdc-wrap">\n   <div id="zgfm-modal-calc-container">\n      <div class="sfdc-alert sfdc-alert-info"> <strong>Info!</strong> Choose your variable. Under Backend tab, you will find variables to be used in mail notification or Submission message </div>\n      <ul role="tablist" class="sfdc-nav sfdc-nav-tabs">\n         <li class="sfdc-active"><a data-toggle="sfdc-tab" role="tab" href="#zgfm-modal-calc-tab-1" aria-expanded="true">Backend</a></li>\n         \x3c!-- <li><a data-toggle="sfdc-tab" role="tab" href="#zgfm-modal-calc-tab-2" aria-expanded="true">Frontend</a></li>--\x3e \n      </ul>\n      <div class="sfdc-tab-content">\n         <div id="zgfm-modal-calc-tab-1" class="sfdc-tab-pane sfdc-in sfdc-active">\n            <h3>Fields</h3>\n          ${this.formvariables_generateTable_process()}\n            <h3>Others</h3>\n            <div class="zgfm-modal-calc-wrap-table">\n               <table class="sfdc-table sfdc-table-striped sfdc-table-bordered sfdc-table-condensed uifm-tab-box-vars-2">\n                  <thead>\n                     <tr>\n                        <th width="150">variables</th>\n                        <th>Code</th>\n                     </tr>\n                  </thead>\n                  <tbody>\n                     <tr>\n                        <td>Summary of submitted data</td>\n                        <td>\n                                                            <p>Default, it shows units and total price</p>\n                                                            <textarea style="width:298px;" onclick="this.select();">[uifm_var opt="rec_summ"]</textarea>\n                                                            \n                                                            <p>it shows without units</p>\n                                                            <textarea style="width:298px;" onclick="this.select();">[uifm_var opt="rec_summ" atr2="show_only_value" ]</textarea>\n                                                            \n                                                            <p>it shows without units and total</p>\n                                                            <textarea style="width:100%;" onclick="this.select();">[uifm_var opt="rec_summ" atr2="show_only_value" atr3="hide_total" ]</textarea>\n                                                            \n                                                        </td>\n                     </tr>\n                     <tr>\n                        <td>Form Url</td>\n                        <td><textarea onclick="this.select();" style="width:298px;">[uifm_var opt="rec_url_fm"]</textarea></td>\n                     </tr>\n                     <tr>\n                        <td>Form name</td>\n                        <td><textarea onclick="this.select();" style="width: 284px;">[uifm_var opt="form_name"]</textarea></td>\n                     </tr>\n                     <tr>\n                        <td>Form record id</td>\n                        <td><textarea onclick="this.select();" style="width: 284px;">[uifm_var opt="rec_id"]</textarea></td>\n                     </tr>\n                     <tr>\n                        <td>User IP</td>\n                        <td><textarea onclick="this.select();">[uifm_var opt="user_ip"]</textarea></td>\n                     </tr>\n                     <tr>\n                        <td>Logged Username</td>\n                        <td><textarea onclick="this.select();">[uifm_var opt="logged_username"]</textarea></td>\n                     </tr>\n                     <tr>\n                        <td>Logged email</td>\n                        <td><textarea onclick="this.select();">[uifm_var opt="logged_email"]</textarea></td>\n                     </tr>\n                  </tbody>\n               </table>\n            </div>\n         </div>\n         <div id="zgfm-modal-calc-tab-2" class="sfdc-tab-pane" style="display:none;">\n            <h3>Fields</h3>\n            <div class="zgfm-modal-calc-wrap-table">\n               <table class="sfdc-table sfdc-table-striped sfdc-table-bordered sfdc-table-condensed uifm-tab-box-vars-1">\n                  <thead>\n                     <tr>\n                        <th rowspan="2">Field</th>\n                        <th colspan="4">Codes</th>\n                     </tr>\n                     <tr>\n                        <th>label</th>\n                        <th>input</th>\n                     </tr>\n                  </thead>\n                  <tbody> </tbody>\n               </table>\n            </div>\n         </div>\n      </div>\n   </div>\n</div>\n\t\t`}formvariables_generateTable_process(){let t="";for(let e in this.availableForms)if(this.availableForms.hasOwnProperty(e)){t+='<div class="uifm_mm_variables_section">',t+=`<div class="uifm_formname"><i class="fa fa-th-list" aria-hidden="true"></i> ${this.availableForms[e].name}</div>`,t+=`<div class="zgfm-modal-calc-wrap-table">\n                                <table class="sfdc-table sfdc-table-striped sfdc-table-bordered sfdc-table-condensed uifm-tab-box-vars-1">\n                                    <thead>\n                                        <tr>\n                                            <th rowspan="2">${this.$uifm("#uifm_mm_frm_variables_field").val()}</th>\n                                            <th colspan="5">${this.$uifm("#uifm_mm_frm_variables_codes").val()}</th>\n                                        </tr>\n                                        <tr>\n                                            <th>${this.$uifm("#uifm_mm_frm_variables_label").val()}</th>\n                                            <th>${this.$uifm("#uifm_mm_frm_variables_input").val()}</th>\n                                            \n                                            <th>${this.$uifm("#uifm_mm_frm_variables_quantity").val()}</th>\n                                            <th>${this.$uifm("#uifm_mm_frm_variables_wrapper").val()} <a data-original-title="you can use this to show content depending if the field has ticked and has a value. if the field has no been ticked or doesnt have a value. the content inside this shortcode will not appear. " data-placement="right" data-toggle="tooltip" href="javascript:void(0);"><span class="fa fa-question-circle"></span></a></th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>`;for(let i in this.availableForms[e].core.steps_src)if(this.availableForms[e].core.steps_src.hasOwnProperty(i))for(let a in this.availableForms[e].core.steps_src[i])if(this.availableForms[e].core.steps_src[i].hasOwnProperty(a)){let s=this.availableForms[e].core.steps_src[i][a].field_name,r=this.availableForms[e].core.steps_src[i][a].id,o=this.availableForms[e].core.steps_src[i][a].type;switch(parseInt(o)){case 6:case 7:case 12:case 13:case 15:case 22:case 23:case 24:case 25:case 26:case 28:case 29:case 30:t+=`<tr>\n                                            <td>${s}</td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="label"]</textarea></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="input"]</textarea></td>\n                                            <td></td>\n                                            \n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_wrap id="${r}_${e}"]here goes your content if field have some value. if no value, this will not appear.[/uifm_wrap]</textarea></td>\n                                        </tr>`;break;case 8:case 10:t+=`<tr>\n                                            <td>${s}</td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="input" atr2="label"]</textarea></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="input" atr2="value"]</textarea></td>\n                                            \n                                            <td></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_wrap id="${r}_${e}"]here goes your content if field have some value. if no value, this will not appear.[/uifm_wrap]</textarea></td>\n                                        </tr>`;break;case 9:case 11:t+=`<tr>\n                                            <td>${s}</td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="input" atr2="label"]</textarea></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="input" atr2="value" atr3="format" atr4="comma" ]</textarea></td>\n                                            \n                                            <td></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_wrap id="${r}_${e}"]here goes your content if field have some value. if no value, this will not appear.[/uifm_wrap]</textarea></td>\n                                        </tr>`;break;case 40:t+=`<tr>\n                                            <td>${s}</td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="label"]</textarea></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="input"]</textarea></td>\n                                            \n                                            <td></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_wrap id="${r}_${e}"]here goes your content if field have some value. if no value, this will not appear.[/uifm_wrap]</textarea></td>\n                                        </tr>`;break;case 16:case 17:case 18:t+=`<tr>\n                                            <td>${s}</td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="label"]</textarea></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="input" atr2="value"]</textarea></td>\n                                            \n                                            <td></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_wrap id="${r}_${e}"]here goes your content if field have some value. if no value, this will not appear.[/uifm_wrap]</textarea></td>\n                                        </tr>`;break;case 41:case 42:t+=`<tr>\n                                            <td>${s}</td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="label"]</textarea></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="input"]</textarea></td>\n                                            \n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="qty"]</textarea></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_wrap id="${r}_${e}"]here goes your content if field have some value. if no value, this will not appear.[/uifm_wrap]</textarea></td>\n                                        </tr>`;break;case 21:t+=`<tr>\n                                            <td>${s}</td>\n                                            <td></td>\n                                            <td><textarea onclick="this.select();" class="uifm_txtarea_var">[uifm_recvar id="${r}_${e}" atr1="input"]</textarea></td>\n                                            \n                                            <td></td>\n                                            <td></td>\n                                        </tr>`}}t+="</tbody>\n                                </table>\n                            </div>",t+="</div>"}return t}changeNodeName(t,e){const i=this.editor.getNodeFromId(t);if(i){i.name=e,i.html=`<div>${e}</div>`,this.editor.updateNodeDataFromId(t,i.data),this.editor.updateNodeNameFromId(t,e);const a=document.querySelector(`#node-${i.id} .drawflow_content_node`);a&&(a.innerHTML=i.html)}}progresstab_refreshPreview(){let t,e,i=this.multistepSettings.progressBar;if(0===parseInt(i.enable_st))return;switch(i.position){case"outertop":t=this.$uifm(".rockfm_form_hook_outertop");break;case"innertop":t=this.$uifm(".rockfm_form_hook_innertop")}this.$uifm(".rockfm_form_hook_outertop").find(".zgfm-progress-bar").remove(),this.$uifm(".rockfm_form_hook_innertop").find(".zgfm-progress-bar").remove();let a=i.theme_type;var s,r="uifm_frm_wiz_css_head";switch(a){case"default":e=" uiform-wiztheme0";var o=this.getUiData4("progressBar","theme",a,"skin_tab_default_txt_bgcolor"),n=this.getUiData4("progressBar","theme",a,"skin_tab_cur_bgcolor"),l=this.getUiData4("progressBar","theme",a,"skin_tab_cur_txtcolor"),m=this.getUiData4("progressBar","theme",a,"skin_tab_cur_numtxtcolor"),c=this.getUiData4("progressBar","theme",a,"skin_tab_inac_bgcolor"),_=this.getUiData4("progressBar","theme",a,"skin_tab_inac_txtcolor"),f=this.getUiData4("progressBar","theme",a,"skin_tab_inac_numtxtcolor"),u=this.getUiData4("progressBar","theme",a,"skin_tab_done_bgcolor"),d=this.getUiData4("progressBar","theme",a,"skin_tab_done_txtcolor"),p=this.getUiData4("progressBar","theme",a,"skin_tab_done_numtxtcolor"),h=this.getUiData4("progressBar","theme",a,"skin_tab_cont_bgcolor"),b=this.getUiData4("progressBar","theme",a,"skin_tab_cont_borcol");this.$uifm("#"+r+"_tab").remove(),s='<style type="text/css" id="'+r+'_tab">',s+=".uiform-wiztheme0 {",0!=parseInt(b.length)&&(s+=" border:1px solid "+b+";"),0!=parseInt(h.length)&&(s+=" background-color: "+h+";"),s+="} ",s+=".uiform-wiztheme0 .zgfm-pbar-steps li a,",s+=".uiform-wiztheme0 .zgfm-pbar-steps li a:hover,",s+=".uiform-wiztheme0 .zgfm-pbar-steps li a:active {",s+="background:"+c+";",s+="color:"+_+";",s+="} ",s+=".uiform-wiztheme0 .zgfm-pbar-steps .uifm-number {",s+="background-color: "+o+"!important;",s+="color:"+f+";",s+="}",s+=".uiform-wiztheme0 .zgfm-pbar-steps .uifm-number:before {",s+=" border-left:14px solid "+c+"!important;",s+="}",s+=".uiform-wiztheme0 .zgfm-pbar-steps .uifm-number:after {",s+=" border-left:14px solid "+c+"!important;",s+="}",s+=".uiform-wiztheme0 .zgfm-pbar-steps .uifm-current .uifm-number {",s+="color:"+m+"!important;",s+="}",s+=".uiform-wiztheme0 .zgfm-pbar-steps .uifm-current .uifm-number:before {",s+="border-left-color: "+n+"!important;",s+="}",s+=".uiform-wiztheme0 .zgfm-pbar-steps .uifm-current .uifm-number:after {",s+="border-left-color: "+n+"!important;",s+="}",s+=".uiform-wiztheme0 .zgfm-pbar-steps li.uifm-current a,",s+=".uiform-wiztheme0 .zgfm-pbar-steps li.uifm-current a:hover,",s+=".uiform-wiztheme0 .zgfm-pbar-steps li.uifm-current a:active {",s+="background:"+n+"!important;",s+="color:"+l+";",s+="} ",s+=".uiform-wiztheme0 .zgfm-pbar-steps li.uifm-current .uifm-number:before{",s+=" border-left:14px solid "+c+";",s+="} ",s+=".uiform-wiztheme0 .zgfm-pbar-steps .uifm-complete .uifm-number {",s+="color: "+p+"!important;",s+="}",s+=".uiform-wiztheme0 .zgfm-pbar-steps .uifm-complete .uifm-number:before {",s+="border-left-color: "+u+"!important;",s+="}",s+=".uiform-wiztheme0 .zgfm-pbar-steps .uifm-complete .uifm-number:after {",s+="border-left-color: "+u+"!important;",s+="}",s+=".uiform-wiztheme0 .zgfm-pbar-steps li.uifm-complete a,",s+=".uiform-wiztheme0 .zgfm-pbar-steps li.uifm-complete a:hover,",s+=".uiform-wiztheme0 .zgfm-pbar-steps li.uifm-complete a:active {",s+="background:"+u+"!important;",s+="color:"+d+";",s+="} ",s+=".uiform-wiztheme0 .zgfm-pbar-steps li.uifm-complete .uifm-number:before{",s+=" border-left:14px solid "+u+";",s+="} ",s+="</style>",this.$uifm("head").append(s);break;case"numbers2":e=" uiform-wiztheme3";n=this.getUiData4("progressBar","theme",a,"skin_tab_cur_bgcolor"),l=this.getUiData4("progressBar","theme",a,"skin_tab_cur_txtcolor"),c=this.getUiData4("progressBar","theme",a,"skin_tab_inac_bgcolor"),_=this.getUiData4("progressBar","theme",a,"skin_tab_inac_txtcolor");this.$uifm("#"+r+"_tab").remove(),s='<style type="text/css" id="'+r+'_tab">',s+=".uiform-wiztheme3 .zgfm-pbar-steps li::before{",s+="background: "+c+";",s+="color:"+_+";",s+="}",s+=".uiform-wiztheme3 .zgfm-pbar-steps li::after{",s+="background: "+c+";",s+="}",s+=".uiform-wiztheme3 .zgfm-pbar-steps li.uifm-current:before,",s+=".uiform-wiztheme3 .zgfm-pbar-steps li.uifm-current:after,",s+=".uiform-wiztheme3 .zgfm-pbar-steps li.uifm-complete:before,",s+=".uiform-wiztheme3 .zgfm-pbar-steps li.uifm-complete:after{",s+="background-color: "+n+"!important;",s+="color:"+l+"!important;",s+="}",s+="</style>",this.$uifm("head").append(s);break;case"numbers":e=" uiform-wiztheme1";n=this.getUiData4("progressBar","theme",a,"skin_tab_cur_bgcolor"),l=this.getUiData4("progressBar","theme",a,"skin_tab_cur_txtcolor"),m=this.getUiData4("progressBar","theme",a,"skin_tab_cur_numtxtcolor");var g=this.getUiData4("progressBar","theme",a,"skin_tab_cur_bg_numtxt");c=this.getUiData4("progressBar","theme",a,"skin_tab_inac_bgcolor"),_=this.getUiData4("progressBar","theme",a,"skin_tab_inac_txtcolor");this.$uifm("#"+r+"_tab").remove(),s='<style type="text/css" id="'+r+'_tab">',s+=".uiform-wiztheme1 .zgfm-pbar-steps li.uifm-current::before,",s+=".uiform-wiztheme1 .zgfm-pbar-steps li.uifm-complete::before,",s+=".uiform-wiztheme1 .zgfm-pbar-steps li.uifm-current .uifm-number,",s+=".uiform-wiztheme1 .zgfm-pbar-steps li.uifm-complete .uifm-number {",s+="border-color:"+n+"!important;",s+="} ",s+=".uiform-wiztheme1 .zgfm-pbar-steps li .uifm-number{",s+="background-color: "+g+";",s+="color:"+m+";",s+="border: 5px solid "+c+";",s+="}",s+=".uiform-wiztheme1 .zgfm-pbar-steps li .uifm-title{",s+="color:"+_+";",s+="}",s+=".uiform-wiztheme1 .zgfm-pbar-steps li::before{",s+="border-top: 4px solid "+c+";",s+="}",s+=".uiform-wiztheme1 .zgfm-pbar-steps li.uifm-complete .uifm-title,",s+=".uiform-wiztheme1 .zgfm-pbar-steps li.uifm-current .uifm-title {",s+="color:"+l+"!important;",s+="}",s+=".uiform-wiztheme1 .zgfm-pbar-steps li.uifm-complete .uifm-number:before{",s+="background-color: "+g+";",s+="}",s+="</style>",this.$uifm("head").append(s)}let v=t.find(".zgfm-progress-bar");v.length||(t.append('<div class="zgfm-progress-bar">\n\t\t\t\t\n\t\t\t</div>'),v=t.find(".zgfm-progress-bar")),v.html(""),v.append(`\n\t\t\t<div class="${e}">\n\t\t\t\t\t<ul class="zgfm-pbar-steps">     \n\t                </ul>\n\t\t\t\t</div>\n\t\t`),v.find(".zgfm-pbar-steps").html("");var k=!1,$=!1;this.multistepSettings.progressBar.progressBarAssigned.includes(String(this.activeFormId))&&(k=!0);let w=1;for(const t in i.steps){if(i.steps.hasOwnProperty(t)){const e=i.steps[t];let s,r="";switch(!0===k&&(e.forms.includes(String(this.activeFormId))&&(r="uifm-current",$=!0),!1===$&&(r="uifm-complete")),a){case"numbers2":s=`\n\t\t\t\t\t\t<li data-index="${e.id}" class="${r}"></li>\n\t\t\t\t\t`;break;default:s=`\n\t\t\t\t\t\t<li data-index="${e.id}" class="${r}">\n\t\t\t\t\t\t\t<a >\n\t\t\t\t\t\t\t\t<span class="uifm-number">${w}</span>\n\t\t\t\t\t\t\t\t<span class="uifm-title">${e.title}</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t`}v.find(".zgfm-pbar-steps").append(s)}w++}}progresstab_tabManualEvt(t){let e=this.$uifm(t),i=e.closest(".uifm_frm_skin_tab_content").attr("data-tab-key");this.setUiData4("progressBar","steps",i,"title",e.val()),this.progresstab_refreshPreview()}progresstab_addNewTab(){let t=this.multistepSettings.progressBar;var e=parseInt(Object.keys(t.steps).length),i=zgfm_back_helper.generateUniqueID(5);0===e&&(this.multistepSettings.progressBar.steps={}),this.addIndexUiData2("progressBar","steps",i);let a={title:"Tab title "+(e+1),forms:[],order:e,id:i};this.setUiData3("progressBar","steps",i,a),this.progresstab_addTabController(a),this.progresstab_select2_refresh(),this.progresstab_refreshPreview()}progresstab_cleanTabs(){this.$uifm("#uifm_frm_skin_tabs_box").html(""),this.multistepSettings.progressBar.steps={},this.progresstab_refreshPreview()}progresstab_deleteTab(t){var e=this.$uifm(t),i=e.closest(".uifm_frm_skin_tab_content").data("tab-key");e.closest(".uifm_frm_skin_tab_content").remove();let a=this.getUiData3("progressBar","steps",i);for(const t in a.forms){const e=a.forms[t];let i=this.multistepSettings.progressBar.progressBarAssigned.indexOf(e);i>-1&&this.multistepSettings.progressBar.progressBarAssigned.splice(i,1)}this.delUiData3("progressBar","steps",i),this.progresstab_refreshPreview()}progresstab_addTabController(t){const e=this;var i=wp.template("zgfm-frm-pbar-templates"),a=this.$uifm('<div class="uifm_temporal_div"></div>');if(""===t.title&&(t.title="Tab title "+(parseInt(t.order)+1)),a.append(i()),a.find(".uifm_frm_skin_tab_content").attr("data-tab-key",t.id),a.find(".uifm_frm_skin_tab_title_evt").attr("id","uifm_frm_skin_tab"+t.id+"_title"),a.find(".uifm_frm_skin_tab_forms_evt").attr("id","uifm_frm_skin_tab"+t.id+"_forms"),a.find(".uifm_frm_skin_tab_title_evt").val(t.title),a.find(".uifm_frm_skin_tab_title_evt").parent().find("label span").html(parseInt(t.order)+1),this.$uifm("#uifm_frm_skin_tabs_box").append(a.find(".uifm_frm_skin_tab_content")),t.forms.length>0){let i=this.progresstab_select2_data_load(),a=this.$uifm("#uifm_frm_skin_tabs_box").find("#uifm_frm_skin_tab"+t.id+"_forms");a.empty(),i.forEach((function(t){a.append(e.$uifm("<option>",{value:t.id,text:t.text}))})),a.val(this.multistepSettings.progressBar.steps[t.id].forms)}}progresstab_select2_onUnselect(t,e){let i=this.multistepSettings.progressBar.progressBarAssigned.indexOf(e);i>-1&&this.multistepSettings.progressBar.progressBarAssigned.splice(i,1),i=this.multistepSettings.progressBar.steps[t].forms.indexOf(e),i>-1&&this.multistepSettings.progressBar.steps[t].forms.splice(i,1)}progresstab_select2_onChange(t,e){let i=this.multistepSettings.progressBar.steps[e].forms;for(let e=0;e<t.length;e++){const a=t[e];this.multistepSettings.progressBar.progressBarAssigned.includes(a)||(i.push(a),this.multistepSettings.progressBar.progressBarAssigned.push(a))}this.multistepSettings.progressBar.steps[e].forms=i,this.progresstab_select2_refresh(),this.progresstab_refreshPreview()}progresstab_select2_refresh(){const t=this;this.$uifm(".uifm_frm_skin_tab_forms_evt").each((function(e,i){(i=t.$uifm(i)).data("select2")&&i.select2("destroy"),i.find("option").each((function(){let e=t.$uifm(this);t.multistepSettings.progressBar.progressBarAssigned.includes(e.val())?e.attr("disabled",!0):e.attr("disabled",!1)})),i.select2({placeholder:"Select an option",theme:"classic",width:"100%",data:t.progresstab_select2_data()}),i.on("change.select2",(function(e){e&&(e.stopPropagation(),e.preventDefault());let i=t.$uifm(e.target).attr("id"),a=t.$uifm("#"+i),s=a.val(),r=a.closest(".uifm_frm_skin_tab_content").attr("data-tab-key");t.progresstab_select2_onChange(s,r),t.$uifm(this).select2("open"),t.$uifm(this).select2("close")})),i.on("select2:unselect",(function(e){e&&(e.stopPropagation(),e.preventDefault());var i=e.params.data;let a=t.$uifm(e.target).attr("id"),s=t.$uifm("#"+a),r=s.val(),o=s.closest(".uifm_frm_skin_tab_content").attr("data-tab-key");t.progresstab_select2_onUnselect(o,i.id),t.progresstab_select2_onChange(r,o),t.$uifm(this).select2("open"),t.$uifm(this).select2("close")}))}))}progresstab_select2_data_load(){let t=[];for(const e in this.availableForms)if(Object.hasOwnProperty.call(this.availableForms,e)){const i=this.availableForms[e];t.push({id:i.id,text:i.name})}return t}progresstab_select2_data(){let t=[];for(const e in this.availableForms)if(Object.hasOwnProperty.call(this.availableForms,e)){const i=this.availableForms[e];this.multistepSettings.progressBar.progressBarAssigned.includes(i.id)||t.push({id:i.id,text:i.name})}return t}progresstab_hidePreview(){let t;switch(this.multistepSettings.progressBar.position){case"outertop":t=this.$uifm(".rockfm_form_hook_outertop");break;case"innertop":t=this.$uifm(".rockfm_form_hook_innertop")}let e=t.find(".zgfm-progress-bar");e.length&&e.hide()}progresstab_enableStatus(){var t=this.$uifm("#uifm_frm_pbar_st").prop("checked")?1:0;this.multistepSettings.progressBar.enable_st=t,1===t?(this.$uifm(".uiform_frm_pbar_main_content").show(),this.progresstab_refreshPreview()):(this.$uifm(".uiform_frm_pbar_main_content").hide(),this.progresstab_hidePreview())}progresstab_updateSettingsTheme(t){switch(this.$uifm(".zgfm_pbar_theme_options_container").hide(),t){case"numbers":this.$uifm("#zgfm_pbar_theme_options_number").show();break;case"numbers2":this.$uifm("#zgfm_pbar_theme_options_number2").show();break;case"default":this.$uifm("#zgfm_pbar_theme_options_default").show()}}progresstab_loadSettings(t,e=!0,i=!0){try{const t=this;if(!i){t.$uifm("#uifm_frm_skin_tabs_box").html("");let e=t.getUiData2("progressBar","steps");for(const i in e)if(Object.hasOwnProperty.call(e,i)){const a=e[i];t.progresstab_addTabController(a)}t.progresstab_select2_refresh()}var a=1===parseInt(t.getUiData2("progressBar","enable_st"));t.$uifm("#uifm_frm_pbar_st").bootstrapSwitchZgpb("state",a);var s=t.getUiData2("progressBar","theme_type");s&&!e&&t.$uifm("#uifm_frm_pbar_theme_type").val(s);var r=t.getUiData2("progressBar","position");switch(t.$uifm("#uifm_frm_pbar_theme_position").val(r),s){case"default":var o=t.getUiData4("progressBar","theme",s,"skin_tab_default_txt_bgcolor");o&&(t.$uifm("#uifm_frm_pbar_tab_inactive_bgcolor").parent().colorpicker("setValue",o),t.$uifm("#uifm_frm_pbar_tab_inactive_bgcolor").val(o)),(p=t.getUiData4("progressBar","theme",s,"skin_tab_cur_bgcolor"))&&(t.$uifm("#uifm_frm_pbar_tab_active_bgcolor").parent().colorpicker("setValue",p),t.$uifm("#uifm_frm_pbar_tab_active_bgcolor").val(p)),(h=t.getUiData4("progressBar","theme",s,"skin_tab_cur_txtcolor"))&&(t.$uifm("#uifm_frm_pbar_tab_active_txtcolor").parent().colorpicker("setValue",h),t.$uifm("#uifm_frm_pbar_tab_active_txtcolor").val(h)),(u=t.getUiData4("progressBar","theme",s,"skin_tab_cur_numtxtcolor"))&&(t.$uifm("#uifm_frm_pbar_tab_active_numtxtcolor").parent().colorpicker("setValue",u),t.$uifm("#uifm_frm_pbar_tab_active_numtxtcolor").val(u)),(b=t.getUiData4("progressBar","theme",s,"skin_tab_inac_bgcolor"))&&(t.$uifm("#uifm_frm_pbar_tab_inactive_bgcolor").parent().colorpicker("setValue",b),t.$uifm("#uifm_frm_pbar_tab_inactive_bgcolor").val(b)),(g=t.getUiData4("progressBar","theme",s,"skin_tab_inac_txtcolor"))&&(t.$uifm("#uifm_frm_pbar_tab_inactive_txtcolor").parent().colorpicker("setValue",g),t.$uifm("#uifm_frm_pbar_tab_inactive_txtcolor").val(g));var n=t.getUiData4("progressBar","theme",s,"skin_tab_inac_numtxtcolor");n&&(t.$uifm("#uifm_frm_pbar_tab_inactive_numtxtcolor").parent().colorpicker("setValue",n),t.$uifm("#uifm_frm_pbar_tab_inactive_numtxtcolor").val(n));var l=t.getUiData4("progressBar","theme",s,"skin_tab_done_bgcolor");l&&(t.$uifm("#uifm_frm_pbar_tab_done_bgcolor").parent().colorpicker("setValue",l),t.$uifm("#uifm_frm_pbar_tab_done_bgcolor").val(l));var m=t.getUiData4("progressBar","theme",s,"skin_tab_done_txtcolor");m&&(t.$uifm("#uifm_frm_pbar_tab_done_txtcolor").parent().colorpicker("setValue",m),t.$uifm("#uifm_frm_pbar_tab_done_txtcolor").val(m));var c=t.getUiData4("progressBar","theme",s,"skin_tab_done_numtxtcolor");c&&(t.$uifm("#uifm_frm_pbar_tab_done_numtxtcolor").parent().colorpicker("setValue",c),t.$uifm("#uifm_frm_pbar_tab_done_numtxtcolor").val(c));var _=t.getUiData4("progressBar","theme",s,"skin_tab_cont_bgcolor");_&&(t.$uifm("#uifm_frm_pbar_tab_cont_bgcolor").parent().colorpicker("setValue",_),t.$uifm("#uifm_frm_pbar_tab_cont_bgcolor").val(_));var f=t.getUiData4("progressBar","theme",s,"skin_tab_cont_borcol");f&&(t.$uifm("#uifm_frm_pbar_tab_cont_borcol").parent().colorpicker("setValue",f),t.$uifm("#uifm_frm_pbar_tab_cont_borcol").val(f));break;case"numbers":var u;(p=t.getUiData4("progressBar","theme",s,"skin_tab_cur_bgcolor"))&&(t.$uifm("#uifm_frm_pbar_tab2_active_bgcolor").parent().colorpicker("setValue",p),t.$uifm("#uifm_frm_pbar_tab2_active_bgcolor").val(p)),(h=t.getUiData4("progressBar","theme",s,"skin_tab_cur_txtcolor"))&&(t.$uifm("#uifm_frm_pbar_tab2_active_txtcolor").parent().colorpicker("setValue",h),t.$uifm("#uifm_frm_pbar_tab2_active_txtcolor").val(h)),(u=t.getUiData4("progressBar","theme",s,"skin_tab_cur_numtxtcolor"))&&(t.$uifm("#uifm_frm_pbar_tab2_active_numtxtcolor").parent().colorpicker("setValue",u),t.$uifm("#uifm_frm_pbar_tab2_active_numtxtcolor").val(u));var d=t.getUiData4("progressBar","theme",s,"skin_tab_cur_bg_numtxt");d&&(t.$uifm("#uifm_frm_pbar_tab2_active_bg_numtxt").parent().colorpicker("setValue",d),t.$uifm("#uifm_frm_pbar_tab2_active_bg_numtxt").val(d)),(b=t.getUiData4("progressBar","theme",s,"skin_tab_inac_bgcolor"))&&(t.$uifm("#uifm_frm_pbar_tab2_inactive_bgcolor").parent().colorpicker("setValue",b),t.$uifm("#uifm_frm_pbar_tab2_inactive_bgcolor").val(b)),(g=t.getUiData4("progressBar","theme",s,"skin_tab_inac_txtcolor"))&&(t.$uifm("#uifm_frm_pbar_tab2_inactive_txtcolor").parent().colorpicker("setValue",g),t.$uifm("#uifm_frm_pbar_tab2_inactive_txtcolor").val(g));break;case"numbers2":var p,h,b,g;(p=t.getUiData4("progressBar","theme",s,"skin_tab_cur_bgcolor"))&&(t.$uifm("#uifm_frm_pbar_tab3_active_bgcolor").parent().colorpicker("setValue",p),t.$uifm("#uifm_frm_pbar_tab3_active_bgcolor").val(p)),(h=t.getUiData4("progressBar","theme",s,"skin_tab_cur_txtcolor"))&&(t.$uifm("#uifm_frm_pbar_tab3_active_txtcolor").parent().colorpicker("setValue",h),t.$uifm("#uifm_frm_pbar_tab3_active_txtcolor").val(h)),(b=t.getUiData4("progressBar","theme",s,"skin_tab_inac_bgcolor"))&&(t.$uifm("#uifm_frm_pbar_tab3_inactive_bgcolor").parent().colorpicker("setValue",b),t.$uifm("#uifm_frm_pbar_tab3_inactive_bgcolor").val(b)),(g=t.getUiData4("progressBar","theme",s,"skin_tab_inac_txtcolor"))&&(t.$uifm("#uifm_frm_pbar_tab3_inactive_txtcolor").parent().colorpicker("setValue",g),t.$uifm("#uifm_frm_pbar_tab3_inactive_txtcolor").val(g))}}catch(t){console.error(" progresstab_setDataToTabSettings : ",t.message)}t.progresstab_updateSettingsTheme(t.getUiData2("progressBar","theme_type"))}}}));